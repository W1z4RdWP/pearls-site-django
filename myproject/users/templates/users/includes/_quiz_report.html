{% extends "layout.html" %}
{% block title %}Отчёт по тесту{% endblock %}
{% block content %}
<div class="container mt-4">
    <h2>Отчёт по тесту: {{ quiz_result.quiz_title }}</h2>
    <p>Правильных ответов: {{ quiz_result.score }} из {{ quiz_result.total_questions }} ({{ quiz_result.percent|floatformat:0 }}%)</p>
    <p>Дата прохождения: {{ quiz_result.completed_at|date:"d.m.Y H:i" }}</p>
    <hr>
    <h4>Детализация по вопросам:</h4>
    <div class="list-group">
        {% for answer in answers %}
        <div class="list-group-item mb-2 {% if answer.is_correct %}list-group-item-success{% else %}list-group-item-danger{% endif %}">
            <strong>Вопрос {{ forloop.counter }}:</strong> {{ answer.question.text }}<br>
            <strong>Ваш ответ:</strong>
            {% if answer.selected_answer %}
                {{ answer.selected_answer.text }}
            {% else %}
                <em>Нет ответа</em>
            {% endif %}
            <br>
            <strong>Правильный ответ:</strong>
            {% for ans in answer.question.answer_set.all %}
                {% if ans.is_correct %}
                    {{ ans.text }}
                {% endif %}
            {% endfor %}
            <br>
            <span>
                {% if answer.is_correct %}
                    <span class="badge bg-success">Верно</span>
                {% else %}
                    <span class="badge bg-danger">Неверно</span>
                {% endif %}
            </span>
        </div>
        {% endfor %}
    </div>
    <a href="{% url 'profile' %}" class="btn btn-primary mt-3">Назад в профиль</a>
</div>
{% endblock %}
